<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">

<div class="container" style="max-width:800px; margin-top:var(--space-12);">

  <!-- Document Header -->
  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:var(--space-6); flex-wrap:wrap;">
    <h1 class="h2">{{ document.title }}</h1>
    <div style="display:flex; gap:8px; flex-wrap:wrap;">
      <!-- Return to ingestion -->
      <a href="{{ url_for('ingestion', project_id=document.project_id) }}">
        <button class="btn btn-outline">‚Üê Back to Ingestion</button>
      </a>
      <!-- Delete Document -->
      <form method="post" style="display:inline;">
        <button class="btn btn-danger" type="submit" name="delete"
                onclick="return confirm('Are you sure you want to delete this document?');">
          Delete
        </button>
      </form>
    </div>
  </div>

  <!-- Document Info -->
  <div class="doc-card" style="padding:var(--space-6); margin-bottom:var(--space-8);">
    <p><b>Uploaded by:</b> {{ document.uploader_name }}</p>
    <p><b>Project:</b> {{ document.project_title }}</p>
    <p><b>Uploaded on:</b> {{ document.upload_date }}</p>
    <p><b>Type:</b> {{ document.type }}</p>
    <p><b>Privacy:</b> {{ document.privacy_level }}</p>
  </div>

  {% if document.ocr_text %}
  <div class="doc-card" style="padding:var(--space-6); margin-bottom:var(--space-8);">
    <p><b>Extracted Text:</b></p>
    <pre id="ocrDisplay" style="white-space:pre-wrap; word-wrap:break-word;">{{ document.ocr_text }}</pre>

    <!-- Edit OCR Text Form -->
    <form id="ocrEditForm" method="post" style="display:none; flex-direction:column; gap:8px;">
      <textarea name="ocr_text" rows="10" style="width:100%;">{{ document.ocr_text }}</textarea>
      <div style="display:flex; gap:8px;">
        <button class="btn btn-primary" type="submit" name="save_ocr">Save</button>
        <button class="btn btn-outline" type="button" onclick="toggleEdit(false)">Cancel</button>
      </div>
    </form>

    <!-- Edit Button -->
    <button class="btn btn-outline" id="editOcrBtn" type="button" onclick="toggleEdit(true)">Edit OCR Text</button>
  </div>
  {% endif %}

  <script>
  function toggleEdit(editing) {
    document.getElementById('ocrDisplay').style.display = editing ? 'none' : 'block';
    document.getElementById('editOcrBtn').style.display = editing ? 'none' : 'inline-block';
    document.getElementById('ocrEditForm').style.display = editing ? 'flex' : 'none';
  }
  </script>
</div>
